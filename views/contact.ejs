<% layout('layouts/boilerplate') %>
<%- include('./partials/navbar') %>
<!-- Back Button -->
 
<!-- <a href="/home" class="position-absolute top-0 start-0 m-3 p-2 bg-white rounded-circle shadow-sm text-warning d-flex align-items-center justify-content-center"
   style="width: 42px; height: 42px; transition: 0.2s;">
  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="22" height="22">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
  </svg>
</a> -->
<!-- Bootstrap 5 CDN -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #f8f9fa;
    }
    .contact-container {
        max-width: 1200px;
        margin: 50px auto;
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        overflow: hidden;
    }
    .map-container iframe {
        width: 100%;
        height: 100%;
        border: 0;
        border-radius: 12px 0 0 12px;
        min-height: 400px;
    }
    .form-control, textarea {
        border-radius: 8px;
    }
    .btn-custom {
        background-color: #0066ec;
        color: white;
        font-weight: 600;
        padding: 10px 25px;
        border-radius: 8px;
        transition: 0.3s;
    }
    .btn-custom:hover {
        background-color: #0b5ed7;
    }
</style>

<div class="container contact-container">
    
    <div class="row g-0">
        
        
        <!-- Map Section -->
        <div class="col-md-6 map-container">
            <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d698.6213426319399!2d78.64116758794515!3d27.80285429956501!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3974e03c4cb8b75f%3A0xdcccc9efdb9ce7a5!2sPadam%20Traders!5e1!3m2!1sen!2sin!4v1756663876902!5m2!1sen!2sin"
                allowfullscreen=""
                loading="lazy">
            </iframe>
        </div>

        <!-- Form Section -->
        <div class="col-md-6 p-5">
            <h2 class="fw-bold mb-3 text-dark text-center">Get in Touch</h2>
            <p class="text-muted mb-4">We'd love to hear from you. Send us your questions or inquiries.</p>

            <!-- Success Message -->
            <div id="successMessage" class="alert alert-success d-none" role="alert">
                Thank you! Your message has been sent successfully.
            </div>

            <form id="contactForm" class="row g-3" method="post" action="/contact">
                <div class="col-md-6">
                    <label for="name" class="form-label">Name</label>
                    <input type="text" id="name" name="name" class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label for="email" class="form-label">Email</label>
                    <input type="email" id="email" name="email" class="form-control" required>
                </div>
                <div class="col-12">
                    <label for="contactNo" class="form-label">Contact No.</label>
                    <input type="tel" id="contactNo" name="contactNo" class="form-control" required>
                </div>
                <div class="col-12">
                    <label for="message" class="form-label">Message</label>
                    <textarea id="message" name="message" rows="5" class="form-control" required></textarea>
                </div>
                <div class="col-12 d-grid">
                    <button type="submit" class="btn btn-warning">Submit</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- JS -->
<script>
    document.getElementById('contactForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        const successMessage = document.getElementById('successMessage');
        const submitButton = this.querySelector('button[type="submit"]');

        submitButton.disabled = true;

        const formData = {
            name: document.getElementById('name').value,
            email: document.getElementById('email').value,
            contactNo: document.getElementById('contactNo').value,
            message: document.getElementById('message').value,
        };

        try {
            const response = await fetch('/contact', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData), 
            });

            // This line will fail if the response is not valid JSON
            const result = await response.json();

            if (result.success) {
                successMessage.classList.remove('d-none');
                setTimeout(() => {
                    successMessage.classList.add('d-none');
                }, 5000);
                this.reset();
            } else {
                alert('An error occurred: ' + result.message);
            }
        } catch(e) {
            console.error('Network error:', e);
            alert('A network error occurred. Please check your connection and try again.');
        } finally {
            submitButton.disabled = false;
        }
    });
</script>

<%- include('./partials/footer') %>
